<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Panel de Proyectos - Versión estática</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: light;
      --bg: #f8fafc;
      --surface: #ffffff;
      --surface-2: #f1f5f9;
      --ink: #0f172a;
      --muted: #475569;
      --border: #e2e8f0;
      --accent: #2563eb;
      --accent-soft: rgba(37, 99, 235, 0.12);
      --success: #16a34a;
      --warning: #f59e0b;
    }

    *, *::before, *::after { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--ink);
    }

    header {
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(12px);
      background: rgba(248, 250, 252, 0.9);
      border-bottom: 1px solid var(--border);
    }

    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px 20px;
      gap: 16px;
    }

    h1 {
      font-size: clamp(1.25rem, 2vw + 1rem, 1.65rem);
      font-weight: 600;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .badge {
      background: var(--accent-soft);
      color: var(--accent);
      border-radius: 999px;
      font-size: 0.75rem;
      padding: 4px 10px;
      font-weight: 600;
    }

    .layout {
      max-width: 1200px;
      margin: 24px auto 80px;
      padding: 0 20px;
      display: grid;
      gap: 20px;
      grid-template-columns: minmax(0, 2fr) minmax(280px, 1fr);
      align-items: start;
    }

    main {
      display: grid;
      gap: 20px;
    }

    section, aside {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 12px 40px rgba(15, 23, 42, 0.05);
    }

    .section-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 16px;
    }

    .section-title h2 {
      font-size: 1.05rem;
      font-weight: 600;
      margin: 0;
    }

    .grid-cards {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
    }

    .card {
      padding: 16px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--surface-2);
      display: grid;
      gap: 8px;
    }

    .card strong {
      font-size: 0.95rem;
    }

    .metric {
      font-size: 1.8rem;
      font-weight: 600;
    }

    .progress {
      width: 100%;
      height: 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.08);
      overflow: hidden;
    }

    .progress span {
      display: block;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), #4c1d95);
    }

    .timeline {
      display: grid;
      gap: 10px;
    }

    .timeline-item {
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 14px;
      display: grid;
      gap: 10px;
    }

    .timeline-item header {
      border: none;
      padding: 0;
      position: static;
      background: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .timeline-item h3 {
      margin: 0;
      font-size: 1rem;
    }

    .timeline-item .meta {
      color: var(--muted);
      font-size: 0.85rem;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: rgba(15, 23, 42, 0.06);
    }

    .pill.success { background: rgba(22, 163, 74, 0.12); color: var(--success); }
    .pill.warning { background: rgba(245, 158, 11, 0.12); color: var(--warning); }

    .meeting {
      padding: 14px;
      border: 1px solid var(--border);
      border-radius: 14px;
      display: grid;
      gap: 8px;
      background: var(--surface);
    }

    .meeting strong {
      font-size: 0.95rem;
    }

    .meeting small {
      color: var(--muted);
    }

    aside {
      display: grid;
      gap: 18px;
    }

    .task-list, .note-list {
      display: grid;
      gap: 12px;
    }

    .task {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px 14px;
      background: var(--surface-2);
      display: grid;
      gap: 8px;
    }

    .task header {
      margin: 0;
      padding: 0;
      border: none;
      display: flex;
      justify-content: space-between;
      align-items: baseline;
    }

    .task h3 {
      margin: 0;
      font-size: 0.95rem;
    }

    .task footer {
      border: none;
      padding: 0;
      color: var(--muted);
      font-size: 0.8rem;
    }

    .note {
      border: 1px dashed var(--border);
      border-radius: 12px;
      padding: 12px;
      background: #ffffff;
    }

    footer.app-footer {
      margin: 40px auto;
      text-align: center;
      color: var(--muted);
      font-size: 0.8rem;
    }

    .empty {
      padding: 30px;
      text-align: center;
      color: var(--muted);
      border: 2px dashed var(--border);
      border-radius: 16px;
    }

    .filters {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .filters button {
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 6px 14px;
      background: #fff;
      color: var(--muted);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .filters button.is-active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    @media (max-width: 980px) {
      .layout { grid-template-columns: 1fr; }
      header { position: sticky; }
    }

    @media (max-width: 640px) {
      .top-bar { flex-direction: column; align-items: flex-start; }
      section, aside { padding: 16px; }
      .filters button { flex: 1 1 auto; text-align: center; }
    }
  </style>
</head>
<body>
  <header>
    <div class="top-bar">
      <h1>📊 Tablero maestro de proyectos</h1>
      <span class="badge" id="projects-count">0 proyectos activos</span>
    </div>
  </header>

  <div class="layout">
    <main>
      <section>
        <div class="section-title">
          <h2>Resumen ejecutivo</h2>
          <div class="filters" id="project-filter"></div>
        </div>
        <div class="grid-cards" id="summary"></div>
      </section>

      <section>
        <div class="section-title">
          <h2>Calendario y jalones</h2>
          <span class="badge" id="milestones-count"></span>
        </div>
        <div class="timeline" id="milestones"></div>
      </section>

      <section>
        <div class="section-title">
          <h2>Próximas reuniones</h2>
          <span class="badge" id="meetings-count"></span>
        </div>
        <div class="timeline" id="meetings"></div>
      </section>
    </main>

    <aside>
      <section>
        <div class="section-title">
          <h2>Tareas pendientes</h2>
          <span class="badge" id="tasks-count"></span>
        </div>
        <div class="task-list" id="tasks"></div>
      </section>

      <section>
        <div class="section-title">
          <h2>Notas rápidas</h2>
        </div>
        <div class="note-list" id="notes"></div>
      </section>
    </aside>
  </div>

  <footer class="app-footer">
    Versionado estático sin dependencias externas. Ideal para abrir en modo local/offline.
  </footer>

  <script id="data" type="application/json">
    {
      "projects": [
        {
          "id": "px-01",
          "nombre": "Implementación ERP Nova",
          "lider": "Mariana Torres",
          "avance": 0.64,
          "inicio": "2025-08-25",
          "entrega": "2025-12-15",
          "presupuesto": 180000,
          "riesgo": "medio"
        },
        {
          "id": "px-02",
          "nombre": "Portal SOPs",
          "lider": "Emilio Vargas",
          "avance": 0.42,
          "inicio": "2025-09-04",
          "entrega": "2025-11-20",
          "presupuesto": 42000,
          "riesgo": "alto"
        },
        {
          "id": "px-03",
          "nombre": "Modernización BI",
          "lider": "Laura Méndez",
          "avance": 0.78,
          "inicio": "2025-07-10",
          "entrega": "2025-10-30",
          "presupuesto": 98000,
          "riesgo": "bajo"
        }
      ],
      "tareas": [
        {
          "id": "tx-1",
          "projectId": "px-01",
          "nombre": "Migración maestros a entorno QA",
          "responsable": "Diego Chávez",
          "inicio": "2025-09-16T09:00:00",
          "fin": "2025-09-16T17:00:00",
          "avance": 0.45,
          "estado": "En curso"
        },
        {
          "id": "tx-2",
          "projectId": "px-02",
          "nombre": "Definir arquitectura de contenidos",
          "responsable": "Silvia Reyes",
          "inicio": "2025-09-17T10:30:00",
          "fin": "2025-09-17T16:00:00",
          "avance": 0.2,
          "estado": "Pendiente"
        },
        {
          "id": "tx-3",
          "projectId": "px-03",
          "nombre": "Pruebas de regresión del dashboard",
          "responsable": "Rafael Solís",
          "inicio": "2025-09-18T09:00:00",
          "fin": "2025-09-18T12:00:00",
          "avance": 0.9,
          "estado": "Por cerrar"
        }
      ],
      "hitos": [
        {
          "id": "mx-1",
          "projectId": "px-01",
          "titulo": "Liberación módulo inventarios",
          "fecha": "2025-09-25",
          "descripcion": "Validación conjunta con el equipo de operaciones.",
          "critico": true
        },
        {
          "id": "mx-2",
          "projectId": "px-02",
          "titulo": "Entrega prototipo navegable",
          "fecha": "2025-10-05",
          "descripcion": "Revisión con stakeholders de servicio interno.",
          "critico": false
        },
        {
          "id": "mx-3",
          "projectId": "px-03",
          "titulo": "Capacitación analistas regionales",
          "fecha": "2025-09-29",
          "descripcion": "Sesión remota para mostrar nuevas vistas.",
          "critico": false
        }
      ],
      "reuniones": [
        {
          "id": "rx-1",
          "projectId": "px-01",
          "titulo": "Kickoff cadena de suministro",
          "enlace": "https://meet.example.com/erp",
          "inicio": "2025-09-19T10:00:00",
          "fin": "2025-09-19T11:00:00",
          "participantes": ["Mariana", "Diego", "Compras"],
          "proposito": "Alinear actividades de migración y pruebas."
        },
        {
          "id": "rx-2",
          "projectId": "px-02",
          "titulo": "Revisión UI + tokens",
          "enlace": "https://meet.example.com/sops",
          "inicio": "2025-09-20T09:30:00",
          "fin": "2025-09-20T10:15:00",
          "participantes": ["Emilio", "Silvia", "UX"],
          "proposito": "Definir lineamientos de contenidos y componentes."
        },
        {
          "id": "rx-3",
          "projectId": "px-03",
          "titulo": "Reporte ejecutivo",
          "enlace": "https://meet.example.com/bi",
          "inicio": "2025-09-21T12:00:00",
          "fin": "2025-09-21T12:45:00",
          "participantes": ["Laura", "Finanzas", "BI"],
          "proposito": "Presentar indicadores de adopción y roadmap."
        }
      ],
      "notas": [
        {
          "id": "nx-1",
          "texto": "Validar riesgos de soporte post-go-live con mesa de ayuda.",
          "autor": "Mariana"
        },
        {
          "id": "nx-2",
          "texto": "Solicitar cotización actualizada de licenciamiento BI.",
          "autor": "Laura"
        }
      ]
    }
  </script>

  <script>
    const data = JSON.parse(document.getElementById('data').textContent);
    const formatCurrency = value => new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN', maximumFractionDigits: 0 }).format(value);
    const formatDate = iso => new Intl.DateTimeFormat('es-MX', { dateStyle: 'medium', timeStyle: iso.includes('T') ? 'short' : undefined }).format(new Date(iso));

    const projects = data.projects;
    const tasks = data.tareas;
    const milestones = data.hitos;
    const meetings = data.reuniones;
    const notes = data.notas;

    const state = {
      selectedProject: 'all'
    };

    const $ = (id) => document.getElementById(id);

    function renderBadges() {
      $('projects-count').textContent = `${projects.length} proyectos activos`;
      $('tasks-count').textContent = `${tasks.length} tareas`; 
      $('milestones-count').textContent = `${milestones.length} jalones`; 
      $('meetings-count').textContent = `${meetings.length} reuniones`;
    }

    function renderFilter() {
      const wrapper = $('project-filter');
      wrapper.innerHTML = '';
      const options = [{ id: 'all', nombre: 'Todo' }, ...projects];
      options.forEach(opt => {
        const button = document.createElement('button');
        button.type = 'button';
        button.textContent = opt.nombre || 'Todo';
        button.className = state.selectedProject === opt.id ? 'is-active' : '';
        button.addEventListener('click', () => {
          state.selectedProject = opt.id;
          renderAll();
        });
        wrapper.appendChild(button);
      });
    }

    function filterByProject(collection) {
      if (state.selectedProject === 'all') return collection;
      return collection.filter(item => item.projectId === state.selectedProject);
    }

    function renderSummary() {
      const container = $('summary');
      container.innerHTML = '';

      const filtered = filterByProject(projects);
      const budget = filtered.reduce((sum, project) => sum + project.presupuesto, 0);
      const avgProgress = filtered.reduce((sum, project) => sum + project.avance, 0) / (filtered.length || 1);
      const critical = filterByProject(milestones).filter(m => m.critico).length;

      const cards = [
        {
          label: 'Inversión comprometida',
          value: formatCurrency(budget),
          description: 'Presupuesto total asociado a los proyectos filtrados.'
        },
        {
          label: 'Avance promedio',
          value: `${Math.round(avgProgress * 100)}%`,
          description: 'Porcentaje promedio de avance reportado por los equipos.'
        },
        {
          label: 'Hitos críticos',
          value: critical,
          description: 'Eventos marcados como críticos dentro de los próximos 30 días.'
        },
        {
          label: 'Personas líderes',
          value: new Set(filtered.map(p => p.lider)).size,
          description: 'Responsables directos de la entrega de cada iniciativa.'
        }
      ];

      cards.forEach(card => {
        const el = document.createElement('article');
        el.className = 'card';
        el.innerHTML = `
          <strong>${card.label}</strong>
          <span class="metric">${card.value}</span>
          <p style="margin:0;color:var(--muted);font-size:0.8rem;">${card.description}</p>
        `;
        container.appendChild(el);
      });
    }

    function renderMilestones() {
      const container = $('milestones');
      container.innerHTML = '';
      const items = filterByProject(milestones)
        .sort((a, b) => new Date(a.fecha) - new Date(b.fecha));

      if (!items.length) {
        container.innerHTML = '<div class="empty">Sin jalones para el proyecto seleccionado.</div>';
        return;
      }

      items.forEach(item => {
        const project = projects.find(p => p.id === item.projectId);
        const el = document.createElement('article');
        el.className = 'timeline-item';
        el.innerHTML = `
          <header>
            <h3>${item.titulo}</h3>
            <span class="pill ${item.critico ? 'warning' : ''}">${item.critico ? 'Crítico' : 'Seguimiento'}</span>
          </header>
          <div class="meta">
            <span>📆 ${formatDate(item.fecha)}</span>
            <span>📁 ${project?.nombre ?? 'Proyecto'}</span>
          </div>
          <p style="margin:0;color:var(--muted);font-size:0.85rem;">${item.descripcion}</p>
        `;
        container.appendChild(el);
      });
    }

    function renderMeetings() {
      const container = $('meetings');
      container.innerHTML = '';
      const items = filterByProject(meetings)
        .sort((a, b) => new Date(a.inicio) - new Date(b.inicio));

      if (!items.length) {
        container.innerHTML = '<div class="empty">No hay reuniones próximas.</div>';
        return;
      }

      items.forEach(item => {
        const project = projects.find(p => p.id === item.projectId);
        const el = document.createElement('article');
        el.className = 'meeting';
        el.innerHTML = `
          <strong>${item.titulo}</strong>
          <small>${formatDate(item.inicio)} · ${project?.nombre ?? 'Proyecto'}</small>
          <p style="margin:0;color:var(--muted);font-size:0.85rem;">${item.proposito}</p>
          <small>Participantes: ${item.participantes.join(', ')}</small>
          <a href="${item.enlace}" target="_blank" rel="noopener" style="font-size:0.8rem;color:var(--accent);">Abrir invitación</a>
        `;
        container.appendChild(el);
      });
    }

    function renderTasks() {
      const container = $('tasks');
      container.innerHTML = '';
      const items = filterByProject(tasks)
        .sort((a, b) => new Date(a.inicio) - new Date(b.inicio));

      if (!items.length) {
        container.innerHTML = '<div class="empty">No se encontraron tareas.</div>';
        return;
      }

      items.forEach(item => {
        const project = projects.find(p => p.id === item.projectId);
        const el = document.createElement('article');
        el.className = 'task';
        el.innerHTML = `
          <header>
            <h3>${item.nombre}</h3>
            <span class="pill">${item.estado}</span>
          </header>
          <div class="progress">
            <span style="width:${Math.round(item.avance * 100)}%"></span>
          </div>
          <p style="margin:0;color:var(--muted);font-size:0.82rem;">${project?.nombre ?? 'Proyecto'} · ${item.responsable}</p>
          <footer>
            ${formatDate(item.inicio)} &mdash; ${formatDate(item.fin)}
          </footer>
        `;
        container.appendChild(el);
      });
    }

    function renderNotes() {
      const container = $('notes');
      container.innerHTML = '';

      if (!notes.length) {
        container.innerHTML = '<div class="empty">Sin notas registradas.</div>';
        return;
      }

      notes.forEach(note => {
        const el = document.createElement('article');
        el.className = 'note';
        el.innerHTML = `
          <p style="margin:0 0 6px 0;font-size:0.9rem;line-height:1.5;">${note.texto}</p>
          <small style="color:var(--muted);">— ${note.autor}</small>
        `;
        container.appendChild(el);
      });
    }

    function renderAll() {
      renderBadges();
      renderFilter();
      renderSummary();
      renderMilestones();
      renderMeetings();
      renderTasks();
      renderNotes();
    }

    renderAll();
  </script>
</body>
</html>
